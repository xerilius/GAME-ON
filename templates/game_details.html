
{% extends 'base.html' %}
{% block content %}
<div class="container">
<h1><a href="/games/{{ game_object.slug }}">{{ game_object.title }}</a></h1>

<script>
	const ssArtworks = {{ ss_artworks | tojson }};
	document.write(`<div class="game-carousel">`);
	document.write(`<div id="gcarousel" class="carousel slide" data-ride="carousel">`);
	document.write(`<div class="carousel-inner">`);
	document.write(`<div class="bg-image"></div>`);
	document.write(`<div class="carousel-item active">`);
	document.write(`<img class="carousel-slides w-100" src="${ssArtworks.slice(0,1)}">`);
	document.write(`</div>`);
	for (const img_url of ssArtworks.slice(1)) {
		document.write(`<div class="carousel-item">`);
		document.write(`<img class="carousel-slides w-100" src="${img_url}">`);
		document.write(`</div>`);
		}
	document.write(`</div>`)
	document.write(`</div>`)
	// Left & right controls for carousel
	document.write(`
	<a class="carousel-control-prev d-flex justify-content-end" href="#gcarousel" role="button" data-slide="prev">  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
	  <span class="sr-only">Previous</span>
	</a>
	<a class="carousel-control-next d-flex justify-content-start" href="#gcarousel" role="button" data-slide="next">
	  <span class="carousel-control-next-icon" aria-hidden="true"></span>
	  <span class="sr-only">Next</span>
	</a>`)
	document.write(`</div>`)
</script>


  <div class="row">
	<div class="col sm-4">
	<p>{{ game_object.summary }}</p><br>
	<p>Release Date: {{ game_object.release_date }}</p><br>

<div class="rating-chart">
	{% if total == 0 %}
	<h5> NO RATINGS </h5>
	{% else %}
	<h5>{{ avg }} AVERAGE BASED ON {{ total }} REVIEW(S)</h5>
	{% endif %}
	<hr style="border:3px solid #f1f1f1">
<div class="row">
	<!-- 5 stars-->
  <div class="side">
    <div><i class="fas fa-grin-stars" data-star-value="5"></i> AMAZING</div>
  </div>
  <div class="middle">
    <div class="bar-container">

      <div class="bar-5" style="width: {{ rating5 }}%!important"></div>
    </div>
  </div>
  <div class="side right">
    <div>{{ r5 }} </div>
  </div>

<!--4 stars-->
  <div class="side">
    <div><i class="fas fa-smile" data-star-value="4"></i> GOOD</div>
  </div>
  <div class="middle">
    <div class="bar-container">
      <div class="bar-4" style="width:{{ rating4 }}%!important"></div>
    </div>
  </div>
  <div class="side right">
    <div> {{ r4 }} </div>
  </div>

  <!-- 3 stars-->
  <div class="side">
    <div> <i class="fas fa-meh" data-star-value="3"></i>  MEH</div>
  </div>
  <div class="middle">
    <div class="bar-container">
      <div class="bar-3" style="width: {{ rating3 }}%!important"></div>
    </div>
  </div>
  <div class="side right">
    <div>{{ r3 }} </div>
  </div>

<!-- 2 stars-->
  <div class="side">
    <div><i class="fas fa-frown-open" aria-hidden="true" data-star-value="2"></i> BAD</div>
  </div>

  <div class="middle">
    <div class="bar-container">
      <div class="bar-2" style="width: {{ rating2 }}%!important"></div>
    </div>
  </div>
  <div class="side right">
    <div> {{ r2 }} </div>
  </div>

  <!-- 1 stars-->
  <div class="side">
    <div><i class="fas fa-poo" aria-hidden="true" data-star-value="1"></i>HORRIBLE</div>
  </div>
  <div class="middle">
    <div class="bar-container">
      <div class="bar-1" style="width: {{ rating1 }}%!important"></div>
    </div>
  </div>
  <div class="side right">
    <div> {{ r1 }} </div>
  </div>
</div>
</div>
<br><br>


<!-- Emoji Game Ratings-->
{% if session.get("Username") %}
<div class="container">
	<form id="rating" action="/games/{{game_object.slug}}" method="POST">
	  <div id="star-ratings-grp">
		<!-- 1 -->
		<label class="star-rating" for="rating-1">
			{% if user_rating != None and user_rating.rating == 1 %}
			<input type="radio" id="rating-1" name="rating" value="1" checked>
			{% else %}
			<input type="radio" id="rating-1" name="rating" value="1">
			{% endif %}
			<i class="fas fa-poo fa-3x" aria-hidden="true" data-star-value="1"></i>
		</label>
		<!-- 2 -->
		<label class="star-rating" for="rating-2">
		  {% if user_rating != None and user_rating.rating == 2 %}
		  <input type="radio" id="rating-2" name="rating" value="2" checked>
		  {% else %}
		  <input type="radio" id="rating-2" name="rating" value="2">
		  {% endif %}
		  <i class="fas fa-frown-open fa-3x" aria-hidden="true" data-star-value="2"></i>
		</label>
		<!-- 3 -->
		<label class="star-rating" for="rating-3">
		  {% if user_rating != None and user_rating.rating == 3 %}
		  <input type="radio" id="rating-3" name="rating" value="3" checked>
		  {% else %}
		  <input type="radio" id="rating-3" name="rating" value="3">
		  {% endif %}
		  <i class="fas fa-meh fa-3x" data-star-value="3"></i>
	   </label>
	   <!-- 4 -->
 	 <label class="star-rating" for="rating-4">
		{% if user_rating != None and user_rating.rating == 4 %}
		<input type="radio" id="rating-4" name="rating" value="4" checked>
		{% else %}
		<input type="radio" id="rating-4" name="rating" value="4">
		{% endif %}
		<i class="fas fa-smile fa-3x" data-star-value="4"></i>
	  </label>
	  <!-- 5 -->
	  <label class="star-rating" for="rating-5">
		  {% if user_rating != None and user_rating.rating == 5 %}
		  <input type="radio" id="rating-5" name="rating" value="5" checked>
		  {% else %}
		  <input type="radio" id="rating-5" name="rating" value="5">
		  {% endif %}
		  <i class="fas fa-grin-stars fa-3x" data-star-value="5"></i>
	  </label>
	</div>
  </form>
</div>
{% endif %}
<div class="container">
	{% for review in reviews %}
	<div class="review-post">
	<br><br>
<!-- User Reviews -->
	Review by User #{{review.user_id}} on {{ review.review_date }}<br>
	{{ review.review }}<br><br>
	{% if user_id == review.user_id %}
	<!--Displaying delete button on the DOM-->
	<input type="button" class="delete-review" value="Delete" data-review-id="{{ review.review_id }}"/>
	{% endif %}
	</div>
	{% endfor %}
	<br><br>
</div>
</div>
</div>
</div>
<!-- user must be signed in to write review-->
{% if session.get("Username") %}
<div class="container">
	<h5 style="margin:0 5%">REVIEWS</h5>
  <div class="row">
  	<div class="column">
	  <form id="review" action="/games/{{game_object.slug}}" method="POST">

	    <label for="review"></label>
	   	<textarea id="ureview" name="ureview" placeholder="Write something..."></textarea><br>
    	<button type="submit" class="btn" id="revbtn">Submit</button>
      </form>
    </div>
  </div>
</div>
{% endif %}

<script src="/static/js/reviews.js"></script>
<script src="/static/js/ratings.js"></script>
{% endblock %}
